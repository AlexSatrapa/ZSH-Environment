function showdiff {
	git status
	GIT_EXTERNAL_DIFF="~/.zsh.d/bbedit-diff-driver" git diff
}

# Inspired by and based on work by J Corbin at
# http://github.com/jcorbin/zsh-git

function switch {
	if [ -z "$1" ] ; then
		git branch
	else
		git checkout $1
	fi
}

# Kitchen-sink gitignore.
# I prepared this to cover all kinds of crud, mainly to protect me from myself.
function prepare_gitignore() {
	cat > .gitignore <<IGNORE
.AppleDouble
.DS_Store
*.pyc
.svn
.hg
tags
*~
*~.*
*.swp
*.mine
*.log
*.bbprojectd
TODO
report
const-local.php
apache/logs
apache/httpd.pid
Build
_build
blib
LICENSE
MANIFEST
MYMETA.*
META.*
.settings-local
IGNORE
}

# http://www.jukie.net/~bart/conf/zsh.d/S55_git
function gitize() {
	git init \
	&& prepare_gitignore \
	&& git add . \
	&& git commit -a -m "Imported into git." \
	&& git gc
}

function pullpush {
	if [ -d .svn -a -d .hg ] ; then
		svn update
		hg update
		svn commit
	else
		git svn rebase && git svn dcommit
	fi
	maketags
}

# experimental wrapper for git to log commits to Day One
# lots of credit to http://nnutter.com/2012/01/git-todo/
# extracted from http://brettterpstra.com/2012/01/16/logging-with-day-one-geek-style/
function commit(){
  msg=$*
  GIT_DIR=$(git rev-parse --git-dir)
  if ! (( $? )); then
      GIT_DIR=$(echo "$GIT_DIR" | awk -F/ '{nlast = NF -1;print $nlast}')
      if [ -z "$GIT_DIR" ]; then
				path=$(pwd)
				GIT_DIR=${path##*/}
      fi
			~/Applications/logtodayone "@$GIT_DIR $msg"
  fi

  git commit -am "$msg"
}